<section class="breadcrumb-option">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="breadcrumb__text">
          <h4>Order Details</h4>
          <div class="breadcrumb__links">
            <a href="/">Home</a>
            <a href="/my-account">My account</a>
            <span>order history</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>



<section class="h-100 gradient-custom">
  <div class="container py-5 h-100">
    <div class="row d-flex justify-content-center align-items-center h-100">
      <div class="col-lg-10 col-xl-8">
        <div class="card" style="border-radius: 10px;">
          {{!-- <div class="card-header px-4 py-5">
            <h5 class="text-muted mb-0">Thanks for your Order, <span style="color: #a8729a;">Anna</span>!</h5>
          </div> --}}
          <div class="card-body p-4">
            <div class="d-flex justify-content-between align-items-center mb-4">
              <p class="lead fw-normal mb-0" style="color: black">order details</p>
              {{!-- <p class="small text-muted mb-0">Receipt Voucher : 1KAU9-84UIL</p> --}}
            </div>
            <button onclick="return confirm('{{orderDetials.[0].productDetails.name}}')"> orderDetials</button>
            {{#each orderDetials}}
            <div class="card shadow-0 border mb-4">
              <div class="card-body">
                <div class="row">
                  <div class="col-md-2">
                    <img src="/images/product/{{this.productDetails.img.[0]}}" class="img-fluid" alt="Phone">
                  </div>
                  <div class="col-md-6 text-center ">
                    <p class="text-dark mb-0"><span>{{this.products.quantity}} </span> <span> X
                      </span>{{this.productDetails.name}}</p><br>
                    <p>Price: ₹ <span>{{this.discountedPrice}}</span></p>

                  </div>

                </div>

                <hr class="mb-4" style="background-color: #e0e0e0; opacity: 1;">
                <div class="row d-flex align-items-center">
                  <div class="col-md-2">
                    <p class="text-muted mb-0 small">Total: ₹ {{this.productTotal}}</p>
                  </div>
                  <div class="col-md-10">
                    <div class="progress" style="height: 6px; border-radius: 16px;">
                      {{#ifEquals this.status 'delivered'}}
                      <div class="progress-bar" role="progressbar"
                        style="width: 100%; border-radius: 16px; background-color: black;" aria-valuenow="100"
                        aria-valuemin="0" aria-valuemax="100"></div>
                    </div>

                    <div class="d-flex justify-content-around mb-1">
                      <p class="text-muted mt-1 mb-0 small ms-xl-5">order placed</p>
                      <p class="text-muted mt-1 mb-0 small ms-xl-5">Delivered</p>
                    </div>
                    {{/ifEquals}}

                    {{#ifEquals this.status 'return applied'}}
                    <div class="progress-bar" role="progressbar"
                      style="width: 100%; border-radius: 16px; background-color: red;" aria-valuenow="100"
                      aria-valuemin="0" aria-valuemax="0"></div>
                  </div>

                  <div class="d-flex justify-content-around mb-1">
                    <p class="text-muted mt-1 mb-0  ms-xl-5">Return Applied</p>
                    {{!-- <p class="text-muted mt-1 mb-0 small ms-xl-5">Delivered</p> --}}
                  </div>

                  {{/ifEquals}}


                  {{#ifEquals this.status 'placed'}}
                  <div class="progress-bar" role="progressbar"
                    style="width: 60%; border-radius: 16px; background-color: black;" aria-valuenow="60"
                    aria-valuemin="0" aria-valuemax="100"></div>
                </div>

                <div class="d-flex justify-content-around mb-1">
                  <p class="text-muted mt-1 mb-0 small ms-xl-5">order placed</p>
                  <p class="text-muted mt-1 mb-0 small ms-xl-5">Delivered</p>
                </div>
                {{/ifEquals}}


                {{#ifEquals this.status 'return approved'}}
                <div class="progress-bar" role="progressbar"
                    style="width: 0%; border-radius: 16px; background-color: black;" aria-valuenow="100"
                    aria-valuemin="0" aria-valuemax="100"></div>
                </div>

                <div class="d-flex justify-content-around mb-1">
                 <strong><p class="text-muted mt-1 mb-0 small ms-xl-5">return approved</p></strong> 
                  {{!-- <p class="text-muted mt-1 mb-0 small ms-xl-5">Delivered</p> --}}
                </div>
                {{/ifEquals}}









              </div>
            </div>
          </div>
        </div>
        {{/each}}

        <div class="d-flex justify-content-between">
          <div class="pt-2">
            <p class="fw-bold mb-0">Address</p>
            <p class="text-muted mb-0">{{address.addressDetails.name}}</p>
            <p class="text-muted mb-0">{{address.addressDetails.address}}</p>
            <p class="text-muted mb-0">{{address.addressDetails.city}}</p>
            <p class="text-muted mb-0">{{address.addressDetails.pincode}}</p>
            <p class="text-muted mb-0">{{address.addressDetails.mobile}}</p>
          </div>

          <div class="pt-2 mt-3">
            <p class="text-muted mb-0">payment method: <span class="text-primary">{{address.paymentMethod}}</span></p>
            <p class="text-muted mb-0">status: <span class="text-primary">{{address.status}}</span></p>
          </div>
        </div>

        {{!-- <div class="d-flex justify-content-between">
          <p class="text-muted mb-0">Invoice Date : 22 Dec,2019</p>
          <p class="text-muted mb-0"><span class="fw-bold me-4">GST 18%</span> 123</p>
        </div> --}}

        {{!-- <div class="d-flex justify-content-between mb-5">
          <p class="text-muted mb-0">Recepits Voucher : 18KU-62IIK</p>
          <p class="text-muted mb-0"><span class="fw-bold me-4">Delivery Charges</span> Free</p>
        </div> --}}
      </div>
      <div class="card-footer border-0 px-4 py-5 mb-5 d-flex justify-content-between"
        style="background-color: black; border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;">
        {{#ifEquals address.status 'delivered'}}



        <!-- Button trigger modal -->
        <button type="button" class="btn site-btn" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
          return order
        </button>

        <!-- Modal -->
        <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1"
          aria-labelledby="staticBackdropLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-header">
                <h1 class="modal-title fs-5" id="staticBackdropLabel">Requesting return</h1>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body">

                <form id="returnRequest">

                  <div class="form-group">
                    <input type="radio" name="reason" value="i dont want this product">
                    <label for="reason">i dont want this product</label>
                  </div>
                  <div class="form-group">
                    <input type="radio" name="reason" value="Poor quality">
                    <label for="reason">Poor quality</label>
                  </div>
                  <div class="form-group">
                    <input type="radio" name="reason" value="ordered by mistake">
                    <label for="reason">ordered by mistake</label>
                  </div>
                  <div class="form-group">
                    <input type="radio" name="reason" value="price of the product is changed">
                    <label for="reason">price of the product is changed</label>
                  </div>

                  <input type="text" name="orderId" value="{{address._id}}" hidden>
                  {{!-- <div class="form-group">
                    <input type="radio" name="reason">
                    <label for="reason"><textarea name="" id="" cols="30" rows="2"
                        placeholder="for other reasons type here"></textarea></label>
                  </div> --}}





                  <button class="btn site-btn btn-sm">Submit Information</button>
                </form>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                {{!-- <button type="button" class="btn btn-primary">Understood</button> --}}
              </div>
            </div>
          </div>
        </div>



        {{/ifEquals}}
        <h5 class="d-flex align-items-center justify-content-end text-white text-uppercase mb-0">Total
          : <span class="h2 mb-0 ms-2">₹ {{orderTotal}}</span></h5>
      </div>
    </div>
  </div>
  </div>
  </div>
</section>

<script>
  $('#returnRequest').submit((e) => {
    e.preventDefault()

    $.ajax({
      url: '/return/approval',
      method: 'post',
      data: $('#returnRequest').serialize(),
      success: (response) => {
        if (response.returnApproval) {
          window.location.reload()
        }
      }
    })
  })

</script>